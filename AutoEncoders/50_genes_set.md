# Single random split
## rat vitro->human vitro 50 genes set
### Autoencoders combined
Training mae:0.012145555578172207, mse:0.00035654945531859994
Validation mae:0.015589396469295025, mse:0.0004834646242670715

### Random forest (high fluctuations!)
Training mae:0.009096651075604683, mse:0.00017655260378680429
Validation mae:0.01630292941157995, mse:0.0005352765465700379

## Rat vitro -> human vitro, 30 random genes
### Random forest
D1 genes: ['Tcf12', 'Nudt19', 'Pkp2', 'Atp6v1b2', 'Khsrp', 'Cyp4f1', 'Vps13b', 'Dnajb6 /// LOC690183', 'Klk5', 'Urb2', 'Adarb1', 'Ssc4d', 'Lrrc14', 'Cybrd1', 'H6pd', 'Nle1', 'Cplx2', 'Pdzrn4', 'Nlk', 'Slc5a2', 'Eya2', 'Lcn2', 'Ofd1', 'Ube2a', 'Mgat3', 'Mocs1', 'Mapk6', 'Filip1', 'Gfi1b', 'LOC100909595 /// Slc2a3']
D2 genes: ['DCAF5', 'LINC00620', 'UST', 'LOC101928259', 'EIF3F', 'LOC100507311', 'SERTAD4-AS1', 'LOC389906', 'SPHKAP', 'RAB10', 'ADRBK2', 'OR5AK4P', 'RRAS2', 'SLC39A3', 'TEX9', 'MGC20647', 'GPR61', 'LOC105378696', 'RIMKLA', 'LSM4', 'MPV17L2', 'ADAMTSL1', 'LOC101929406', 'SLC16A1', 'SERPINB7', 'SEMA4F', 'SLC29A2', 'PREPL', 'FBXL18', 'NDUFV1']

Training mae:0.008720280782541362, mse:0.00014369255631464786
Validation mae:0.01555645225244078, mse:0.0004368708356941033

D1 genes: ['Dvl2', 'Pbxip1', 'Cltb', 'Tas2r114', 'Lilra3 /// Lilrb1 /// Lilrb3a /// Lilrb3b /// Lilrb3l /// LOC690948', 'Ankrd36', 'Tfpi2', 'Myo10', 'Tnrc18', 'Nkg7', 'Vstm2a', 'LOC102551716', 'Tmigd1', 'Wwox', 'Shpk', 'Rrp9', 'LOC102550922 /// Tg', 'Oxt', 'Gdpd3', 'Gip', 'Mon1b', 'P3h4', 'Oxtr', 'Nif3l1', 'Celf2', 'Klhl8', 'Mycs', 'Haus8 /// LOC100364316', 'LOC102556054', 'Katna1']
D2 genes: ['PTGDS', 'TSNARE1', 'MPHOSPH8', 'DSE', 'GPR143', 'ACP5', 'MAGI2-AS3', 'LINC00935', 'SLC36A4', 'METAP2', 'STK35', 'LOC100505664', 'GNA14-AS1', 'CYP51A1-AS1', 'ALDH3B1', 'LOC389895', 'UBAP1', 'SPOCD1', 'LINC00537', 'PAGE1', 'TAS2R14', 'HECA', 'PIWIL4', 'LOC105377782 /// LOC286087', 'LOC105373113', 'HADHA', 'VCPIP1', 'KIZ-AS1', 'SORBS3', 'LOC101929060 /// MIER2']

Training mae:0.00972636843296772, mse:0.00017135481754680388
Validation mae:0.017953174761482196, mse:0.0005725029049993979

## Rat vitro -> rat vivo 50 genes set
### Autoencoders combined
Training mae:0.018068501725792885, mse:0.0008013502229005098
Validation mae:0.02461603656411171, mse:0.001310129533521831
### Random forest
Training mae:0.013992955270287192, mse:0.0004193682877536548
Validation mae:0.025123195775998808, mse:0.0013118648613927428

# Leave-one-out rat vitro -> human vitro, 50 genes set
### AutoEncoders, all with old loss function
Training mae:0.014450378715991974, mse:0.0004609850875567645
Validation mae:0.019649896770715714, mse:0.0008163460297510028
Replicate Corrected MAE: 0.014609633857476797
Replicate Corrected MSE: 0.0006569672340910274

Compounds sorted by validation MAE (compound, MAE):
AM 0.013189591
TRZ 0.014046472
PHE 0.0143163875
CFB 0.014697018
GBC 0.015020612
FP 0.015199135
CPA 0.015817268
HCB 0.016028224
ASA 0.016201187
CBZ 0.016276525
APL 0.016388433
LBT 0.016543044
IM 0.016958632
GFZ 0.017123302
BBZ 0.01733542
ADP 0.01740274
PH 0.01746213
RIF 0.017767088
SS 0.018379562
MTS 0.018417716
ANIT 0.01846739
KC 0.01856115
PhB 0.018633083
DFNa 0.019064989
FT 0.019109005
WY 0.019371059
LS 0.019399201
HPL 0.01944483
NFT 0.019496769
CIM 0.019586567
CMA 0.020025348
AZP 0.020223977
GF 0.020512262
OPZ 0.020922085
DZP 0.021372404
TAA 0.02169732
MP 0.021868989
AA 0.022070237
PTU 0.022359515
PB 0.02269403
CPZ 0.023028813
APAP 0.024125574
VPA 0.024615847
BBr 0.025202697
INAH 0.029552123
TC 0.030006936
ET 0.037562598


### Old loss AutoEncoders with doubling for domain-specific
Training mae:0.01407614815980196, mse:0.00043529877439141273
Validation mae:0.019754337146878242, mse:0.0008199537405744195
(slight increase compared to non-doubling)

Compounds sorted by validation MAE (compound, MAE):
AM 0.013652668
TRZ 0.014286974
HCB 0.0145967705
CPA 0.015076363
PHE 0.0155801475
CFB 0.015670445
GBC 0.015732145
FP 0.0159658
GFZ 0.016480183
APL 0.016540349
CBZ 0.016561477
LBT 0.016684249
ADP 0.017245395
ASA 0.017335432
PH 0.017461278
IM 0.01746349
PhB 0.017789109
ANIT 0.017917601
BBZ 0.017996747
HPL 0.01801677
DFNa 0.01850083
KC 0.018749533
MTS 0.018767757
CMA 0.018992502
SS 0.01909403
NFT 0.019160427
LS 0.019276917
WY 0.019703833
RIF 0.019835271
FT 0.020099182
GF 0.020251764
CIM 0.020626748
AZP 0.02081942
DZP 0.02169283
OPZ 0.021693997
TAA 0.021968747
MP 0.021986093
PTU 0.022198474
PB 0.0225119
AA 0.022907978
APAP 0.023192203
VPA 0.023283083
CPZ 0.02353192
BBr 0.024199719
INAH 0.029406823
TC 0.029601002
ET 0.038347445

### AutoEncoders with new loss function for combined net (no doubling)
Training mae:0.014557319693267345, mse:0.000468430487671867
Validation mae:0.019741354510188103, mse:0.0008263517520390451
Replicate-corrected validation MAE: 0.014705691609716584
Replicate Corrected MSE: 0.0006659819130415876

Compounds sorted by validation MAE (compound, MAE):
TRZ 0.013718068
PHE 0.013811629
CFB 0.013880743
HCB 0.014173755
AM 0.0151086105
CPA 0.01516516
GBC 0.015171841
ASA 0.015832195
APL 0.01590144
FP 0.01593186
LBT 0.016014166
GFZ 0.016574657
IM 0.016663957
CBZ 0.017063672
PH 0.017246632
PhB 0.017298285
MTS 0.0175398
BBZ 0.01770923
DFNa 0.018547637
ADP 0.01860555
RIF 0.018618409
KC 0.018954478
FT 0.018979823
SS 0.019037835
CMA 0.01907755
HPL 0.019383013
ANIT 0.019792903
NFT 0.019876188
WY 0.020033304
GF 0.020073196
CIM 0.020273784
LS 0.020475643
OPZ 0.02117762
TAA 0.021190636
AZP 0.021509318
AA 0.02171799
MP 0.022023741
DZP 0.022355283
BBr 0.022441821
PB 0.022963025
PTU 0.02311923
CPZ 0.024010075
APAP 0.024669902
VPA 0.025661852
INAH 0.029608943
TC 0.03000335
ET 0.038855955

### New loss autoencoders with doubling (new loss for autoencoders as well)
Training mae:0.014209164306521416, mse:0.0004453459696378559
Validation mae:0.01987835392355919, mse:0.0008333639125339687
Compounds sorted by validation MAE (compound, MAE):
AM 0.013076301
HCB 0.01406548
CFB 0.014621235
TRZ 0.014691366
PHE 0.014786377
GFZ 0.015244149
CBZ 0.015540193
ASA 0.016014885
FP 0.016156789
IM 0.016512146
LBT 0.016597122
APL 0.016730592
PH 0.01687034
CPA 0.017136611
GBC 0.017364394
ADP 0.0178945
MTS 0.018029414
PhB 0.018047096
HPL 0.018691275
KC 0.018806577
DFNa 0.01902193
WY 0.019114207
CMA 0.019289855
SS 0.019321814
ANIT 0.019398766
NFT 0.019438794
FT 0.019515043
BBZ 0.0195252
RIF 0.019583099
GF 0.020171976
CIM 0.020413479
AZP 0.02048896
OPZ 0.020641105
LS 0.020790169
DZP 0.021497091
MP 0.022117604
TAA 0.022285245
AA 0.023426946
CPZ 0.023440443
PB 0.023494702
PTU 0.02369555
VPA 0.023964208
APAP 0.024464255
BBr 0.024494454
INAH 0.029470501
TC 0.029611506
ET 0.038728964


### Random forest, 50 genes set
Training mae:0.009643454843683471, mse:0.00019218381761854165
Validation mae:0.018704591865039352, mse:0.000742544161968681
Compounds sorted by validation MAE (compound, MAE):
AM 0.012708766120368212
TRZ 0.01361277477974077
PHE 0.013669972967702304
HCB 0.014092216542757701
CFB 0.014238413235027307
GBC 0.014603724398307432
FP 0.014612487522966067
CPA 0.014909510280150251
LBT 0.015432456718635029
ASA 0.015482020908598244
APL 0.015525957937571236
IM 0.0156884765235523
GFZ 0.015711917973110452
CBZ 0.015933101179838118
PH 0.016258233073020094
ADP 0.016809866251492035
BBZ 0.01695654527674234
MTS 0.017017409848887267
RIF 0.017112637471075304
SS 0.017359052061180835
HPL 0.01769103274886757
PhB 0.0177452523769985
DFNa 0.017932783300975023
ANIT 0.017957750626419567
CMA 0.01802069239629317
WY 0.018289460063375684
FT 0.018346727603343337
NFT 0.01868093769207942
LS 0.018718436212521037
GF 0.019341227992867013
CIM 0.019569164157304097
KC 0.019750114370168503
PB 0.020077960692508973
AZP 0.020296164104554554
OPZ 0.02036899868421888
DZP 0.020458435441673705
TAA 0.020516513123076542
BBr 0.020568000680681927
AA 0.020822045930003488
MP 0.021172670686338064
PTU 0.021860547489021928
CPZ 0.022340882061500106
APAP 0.022705090030290663
VPA 0.02343755282330127
INAH 0.02871919724156579
TC 0.029045822997417817
ET 0.036946815058759366

# Leave-one-out rat vitro -> rat vivo, 50 genes set
## Normal AE: no doubling, normal loss
Training mae:0.021611860021948814, mse:0.0010461120400577784
Validation mae:0.030839908868074417, mse:0.0019656536169350147

Compounds sorted by validation MAE (compound, MAE):
BBr 0.02516984
MTS 0.025669236
TAA 0.025989348
AA 0.026366377
DZP 0.026833005
CFB 0.026851773
HCB 0.027372641
PhB 0.027520292
FP 0.027709989
LBT 0.027896462
CIM 0.028162558
TRZ 0.028589753
AZP 0.028605761
DFNa 0.028903197
SS 0.028952507
CBZ 0.028960152
PTU 0.028972197
GBC 0.029133303
HPL 0.029138489
PH 0.029191608
GF 0.029294804
PHE 0.029903565
RIF 0.030032083
FT 0.03092742
NFT 0.031036451
KC 0.031105269
OPZ 0.031300798
INAH 0.031586148
WY 0.03178554
AM 0.032109514
MP 0.03240454
CPA 0.033164553
LS 0.033200823
CMA 0.033245172
ASA 0.033436928
VPA 0.03401068
APAP 0.03437576
ET 0.03438816
BBZ 0.034422297
GFZ 0.034847207
TC 0.035190467
ANIT 0.036013592
APL 0.036313593
PB 0.037051212
IM 0.040661205

## RF
Training mae:0.015173646705775807, mse:0.00047824470541096186
Validation mae:0.02881035605701583, mse:0.0017113072721024812
Compounds sorted by validation MAE (compound, MAE):
BBr 0.0238222434088048
MTS 0.024111348005252754
AA 0.02549555654734896
CFB 0.025561213695423843
PH 0.025767029419579916
CBZ 0.025891129484892236
HCB 0.02599374882284219
PTU 0.026007568251677063
CIM 0.026077853040444802
SS 0.026179793737535106
AZP 0.02643229138627799
LBT 0.02646264501546483
GBC 0.026819377388374813
DZP 0.02686569733309453
TAA 0.02693188584873437
PhB 0.026959564336864403
HPL 0.026994372575276707
AM 0.02771467258237915
DFNa 0.0277823626759464
FT 0.027909895828697406
INAH 0.02798882957208715
GF 0.028012635129650337
TRZ 0.028177745730419645
OPZ 0.02902621717699339
VPA 0.02921933398603306
ET 0.029510618037691696
RIF 0.029743856025819908
LS 0.029770233245603826
FP 0.029830368962503108
KC 0.03011813171958977
NFT 0.030167899022201537
WY 0.030336494255835157
PB 0.030489541909788045
PHE 0.030513714295889748
MP 0.030543531376356806
TC 0.030864834845566246
GFZ 0.03093451181669824
CMA 0.031249645858995055
ASA 0.03171951151651585
BBZ 0.03203560545769134
APAP 0.03221391611011691
CPA 0.03257082077825178
APL 0.03262933282036025
ANIT 0.03343901727012641
IM 0.039579426260014684


# Doubling vs non-doubling AE, new and old loss (rat vitro -> human vitro)
## No doubling, normal loss
Original MAE: 0.0196499
Original MSE: 0.0008163459
Replicate Corrected MAE: 0.014609633857476797
Replicate Corrected MSE: 0.0006569672340910274

## No doubling, custom loss
Original MAE: 0.019741356
Original MSE: 0.0008263518
Replicate Corrected MAE: 0.014705691609716584
Replicate Corrected MSE: 0.0006659819130415876

## Doubling, normal loss
Original MAE: 0.019754337
Original MSE: 0.0008199537
Replicate Corrected MAE: 0.014738143399780523
Replicate Corrected MSE: 0.0006604782104036434

## Doubling, custom loss
Original MAE: 0.019878354
Original MSE: 0.0008333639
Replicate Corrected MAE: 0.014857661058294011
Replicate Corrected MSE: 0.0006721392955882011

# RF vitro -> vitro
Training mae:0.009643116310105563, mse:0.00019216108529547722
Validation mae:0.018693799711722074, mse:0.0007387570803958685
Compounds sorted by validation MAE (compound, MAE):
AM 0.01304726033434162
TRZ 0.013588378527042012
PHE 0.013682875976993948
HCB 0.014091777809493769
CFB 0.01418935940362236
FP 0.014684497006480036
GBC 0.014699642936547453
CPA 0.014830224789809457
LBT 0.015511526242191327
ASA 0.015539647746104626
APL 0.015553796766113119
IM 0.01564618196148593
GFZ 0.015691561399634662
PH 0.016180981089300637
CBZ 0.016255179024342776
ADP 0.016750543610109334
RIF 0.016991950690960444
BBZ 0.017010030174842147
MTS 0.017048790651757486
SS 0.017504422943424722
HPL 0.01770001274497883
PhB 0.017703802741944278
ANIT 0.017825674669036364
CMA 0.01799722825958295
DFNa 0.018061663571048145
FT 0.01823440160130707
WY 0.018268075310882387
LS 0.018329992761363312
NFT 0.018753043615232935
GF 0.019386471619174634
KC 0.019444399175693558
CIM 0.019543387307130365
PB 0.02002063566505582
AZP 0.020244345766495198
TAA 0.020302613793306175
OPZ 0.02046024556855882
DZP 0.02053503024143794
AA 0.02076228466027792
BBr 0.020776737031110337
MP 0.02110447387650855
PTU 0.021682995058529574
CPZ 0.022461350885385478
APAP 0.022719186453196188
VPA 0.023200015636413107
INAH 0.028649603717916517
TC 0.028901889381133472
ET 0.037040396253639675